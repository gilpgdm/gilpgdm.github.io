<muestra-codigo>
 <div>
  <div><span
     style="color: #008000;">/**</span></div>
  <div><span
     style="color: #008000;">&nbsp;*&nbsp;Devuelve una literal de objeto que se
    puede usar para enviar</span></div>
  <div><span
     style="color: #008000;">&nbsp;*&nbsp;en formato JSON al servidor.</span>
  </div>
  <div><span
     style="color: #008000;">&nbsp;*&nbsp;DTO es un acr√≥nimo para Data Transder
    Object, u</span></div>
  <div><span
     style="color: #008000;">&nbsp;*&nbsp;objeto para transferencia de
    datos.</span></div>
  <div><span
     style="color: #008000;">&nbsp;*&nbsp;</span><span
     style="color: #0000ff;">@param</span><span
     style="color: #008000;"> </span><span
     style="color: #267f99;">{ PushSubscription }</span><span
     style="color: #008000;"> </span><span
     style="color: #001080;">suscripcion</span></div>
  <div><span
     style="color: #008000;">&nbsp;*/</span></div>
  <div><span
     style="color: #af00db;">export</span> <span
     style="color: #0000ff;">function</span> <span
     style="color: #795e26;">calculaDtoParaSuscripcion</span>(<span
     style="color: #001080;">suscripcion</span>)&nbsp;{</div>
  <div>&nbsp;<span
     style="color: #0000ff;">const</span> <span
     style="color: #0070c1;">key</span> = <span
     style="color: #001080;">suscripcion</span>.<span
     style="color: #795e26;">getKey</span>(<span
     style="color: #a31515;">"p256dh"</span>)</div>
  <div>&nbsp;<span
     style="color: #0000ff;">const</span> <span
     style="color: #0070c1;">token</span> = <span
     style="color: #001080;">suscripcion</span>.<span
     style="color: #795e26;">getKey</span>(<span
     style="color: #a31515;">"auth"</span>)</div>
  <div>&nbsp;<span
     style="color: #0000ff;">const</span> <span
     style="color: #0070c1;">supported</span> = <span
     style="color: #267f99;">PushManager</span>.<span
     style="color: #0070c1;">supportedContentEncodings</span></div>
  <div>&nbsp;<span
     style="color: #0000ff;">const</span> <span
     style="color: #0070c1;">encodings</span> = <span
     style="color: #267f99;">Array</span>.<span
     style="color: #795e26;">isArray</span>(<span
     style="color: #0070c1;">supported</span>) &amp;&amp; <span
     style="color: #0070c1;">supported</span>.<span
     style="color: #001080;">length</span> &gt; <span
     style="color: #098658;">0</span></div>
  <div>&nbsp;&nbsp;? <span
     style="color: #0070c1;">supported</span></div>
  <div>&nbsp;&nbsp;: [<span
     style="color: #a31515;">"aesgcm"</span>]</div>
  <div>&nbsp;<span
     style="color: #0000ff;">const</span> <span
     style="color: #0070c1;">endpoint</span> = <span
     style="color: #001080;">suscripcion</span>.<span
     style="color: #0070c1;">endpoint</span></div>
  <div>&nbsp;<span
     style="color: #0000ff;">const</span> <span
     style="color: #0070c1;">publicKey</span> = <span
     style="color: #0070c1;">key</span> === <span
     style="color: #0000ff;">null</span></div>
  <div>&nbsp;&nbsp;? <span
     style="color: #0000ff;">null</span></div>
  <div>&nbsp;&nbsp;: <span
     style="color: #795e26;">btoa</span>(<span
     style="color: #267f99;">String</span>.<span
     style="color: #795e26;">fromCharCode</span>.<span
     style="color: #795e26;">apply</span>(<span
     style="color: #0000ff;">null</span>, <span
     style="color: #0000ff;">new</span> <span
     style="color: #267f99;">Uint8Array</span>(<span
     style="color: #0070c1;">key</span>)))</div>
  <div>&nbsp;<span
     style="color: #0000ff;">const</span> <span
     style="color: #0070c1;">authToken</span> = <span
     style="color: #0070c1;">token</span> === <span
     style="color: #0000ff;">null</span></div>
  <div>&nbsp;&nbsp;? <span
     style="color: #0000ff;">null</span></div>
  <div>&nbsp;&nbsp;: <span
     style="color: #795e26;">btoa</span>(<span
     style="color: #267f99;">String</span>.<span
     style="color: #795e26;">fromCharCode</span>.<span
     style="color: #795e26;">apply</span>(<span
     style="color: #0000ff;">null</span>, <span
     style="color: #0000ff;">new</span> <span
     style="color: #267f99;">Uint8Array</span>(<span
     style="color: #0070c1;">token</span>)))</div>
  <div>&nbsp;<span
     style="color: #0000ff;">const</span> <span
     style="color: #0070c1;">contentEncoding</span> = <span
     style="color: #0070c1;">encodings</span>[<span
     style="color: #098658;">0</span>]</div>
  <div>&nbsp;<span
     style="color: #af00db;">return</span>&nbsp;{</div>
  <div>&nbsp;&nbsp;<span
     style="color: #001080;">endpoint</span>,</div>
  <div>&nbsp;&nbsp;<span
     style="color: #001080;">publicKey</span>,</div>
  <div>&nbsp;&nbsp;<span
     style="color: #001080;">authToken</span>,</div>
  <div>&nbsp;&nbsp;<span
     style="color: #001080;">contentEncoding</span></div>
  <div>&nbsp;}</div>
  <div>}</div><br>
 </div>
</muestra-codigo>